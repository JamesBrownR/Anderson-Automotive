<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Anderson Automotive - Auto Repair Oklahoma City | (405) 896-8184</title>
<meta name="description" content="Anderson Automotive - Professional auto repair and service in Oklahoma City. Call +1 (405) 896-8184 for honest diagnostics and fast turnarounds." />
<style>
  :root{
    --accent-red: #d62b2b;
    --accent-dark: #1b1b1d;
    --bg-dark: #0f0f10;
    --muted: #f2f2f2;
    --card-bg: #111213;
    --accent-light: #ff5a5a;
    --max-width: 1200px;
    --radius: 12px;
    --shadow: 0 8px 32px rgba(0,0,0,0.4);
    --border: rgba(255,255,255,0.08);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,#0b0b0c 0%, #1a1a1b 50%, #131213 100%);
    color:var(--muted);
    -webkit-font-smoothing:antialiased;
    line-height:1.5;
    min-height:100vh;
  }

  /* Top Banner */
  .top-banner{
    background: linear-gradient(135deg, #2a0a0a 0%, var(--accent-red) 100%);
    padding: 12px 20px;
    text-align: center;
    color: white;
    font-weight: 600;
    font-size: 16px;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 10px rgba(214,43,43,0.3);
  }
  .top-banner a{
    color: white;
    text-decoration: none;
    transition: all 0.3s ease;
    padding: 8px 16px;
    border-radius: 6px;
    background: rgba(255,255,255,0.15);
    margin: 0 8px;
    display: inline-block;
  }
  .top-banner a:hover{
    background: rgba(255,255,255,0.25);
    transform: translateY(-1px);
  }

  header{
    background: linear-gradient(135deg, rgba(214,43,43,0.95) 0%, rgba(40,6,6,0.9) 100%);
    padding: 18px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    position: sticky;
    top: 0;
    z-index: 50;
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
  }
  .brand{
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .brand h1{
    margin: 0;
    font-size: 28px;
    font-weight: 800;
    letter-spacing: 2px;
    color: #fff;
    text-shadow: 0 3px 10px rgba(0,0,0,0.5);
    background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .logo{
    width: 52px;
    height: 52px;
    border-radius: 10px;
    background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.05) 100%);
    border: 2px solid rgba(255,255,255,0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
  }
  .header-contact{
    text-align: right;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .header-contact .phone{
    font-weight: 700;
    font-size: 18px;
    color: #fff;
    text-decoration: none;
    background: rgba(0,0,0,0.2);
    padding: 10px 16px;
    border-radius: 10px;
    transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.2);
  }
  .header-contact .phone:hover{
    background: rgba(0,0,0,0.3);
    transform: translateY(-2px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }
  .header-contact .email{
    color: rgba(255,255,255,0.9);
    text-decoration: none;
    font-size: 14px;
    transition: color 0.3s ease;
  }
  .header-contact .email:hover{
    color: #fff;
    text-decoration: underline;
  }
  .address{
    font-size: 13px;
    color: rgba(255,255,255,0.8);
    margin-top: 2px;
  }

  main{
    max-width: var(--max-width);
    margin: 32px auto;
    padding: 0 20px 100px;
  }

  .hero{
    display: grid;
    grid-template-columns: 1fr 400px;
    gap: 24px;
    margin-bottom: 32px;
  }
  .card{
    background: linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
    border-radius: var(--radius);
    padding: 24px;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    backdrop-filter: blur(10px);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .card:hover{
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(0,0,0,0.5);
  }

  .about h2{
    margin: 0 0 12px 0;
    color: var(--accent-red);
    font-size: 24px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .about h2:before{
    content: "🔧";
    font-size: 20px;
  }
  .about p{
    margin: 0;
    color: #e9e9e9;
    font-size: 16px;
    line-height: 1.6;
  }

  .info-section{
    margin-top: 20px;
    padding: 16px;
    background: rgba(255,255,255,0.02);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.05);
  }
  .info-section .title{
    color: var(--accent-red);
    font-weight: 600;
    font-size: 16px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .hours{
    font-size: 14px;
    color: #dcdcdc;
  }
  .hours .row{
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px dashed rgba(255,255,255,0.1);
    transition: background 0.3s ease;
  }
  .hours .row:hover{
    background: rgba(255,255,255,0.02);
  }
  .hours .row:last-child{border-bottom: none}

  .map-embed{
    height: 320px;
    border-radius: 12px;
    overflow: hidden;
    border: 2px solid var(--border);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }

  .gallery{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 12px;
  }
  .gallery img{
    width: 100%;
    height: 160px;
    object-fit: cover;
    border-radius: 10px;
    display: block;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid var(--border);
  }
  .gallery img:hover{
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  }

  .sidebar{
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .contact-card h3{
    margin: 0 0 8px 0;
    color: var(--accent-red);
    font-size: 20px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .contact-card h3:before{
    content: "📞";
    font-size: 16px;
  }

  form{
    display: grid;
    gap: 16px;
  }
  form label{
    display: block;
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 6px;
    color: #fff;
  }
  form input, form textarea{
    width: 100%;
    padding: 12px 16px;
    border-radius: 10px;
    border: 2px solid rgba(255,255,255,0.1);
    background: rgba(0,0,0,0.2);
    color: var(--muted);
    font-size: 15px;
    outline: none;
    transition: all 0.3s ease;
    font-family: inherit;
  }
  form input:focus, form textarea:focus{
    border-color: var(--accent-red);
    background: rgba(0,0,0,0.3);
    box-shadow: 0 0 0 3px rgba(214,43,43,0.1);
  }
  .btn{
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background: linear-gradient(135deg, var(--accent-red) 0%, #b91c1c 100%);
    color: #fff;
    padding: 14px 20px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    font-size: 15px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(214,43,43,0.3);
    text-decoration: none;
  }
  .btn:hover{
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(214,43,43,0.4);
    background: linear-gradient(135deg, #b91c1c 0%, var(--accent-red) 100%);
  }

  .quick-links{
    display: grid;
    gap: 10px;
  }
  .quick-links a{
    color: #ddd;
    text-decoration: none;
    padding: 10px;
    border-radius: 8px;
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    transition: all 0.3s ease;
    font-size: 14px;
  }
  .quick-links a:hover{
    background: rgba(255,255,255,0.05);
    color: #fff;
  }

  .reviews-grid{
    margin-top: 20px;
    display: grid;
    gap: 16px;
  }
  .review{
    display: flex;
    gap: 16px;
    align-items: flex-start;
    padding: 20px;
    border-radius: 12px;
    background: linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
    border: 1px solid var(--border);
    transition: all 0.3s ease;
  }
  .review:hover{
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
  }
  .avatar{
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--accent-red) 0%, #b91c1c 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: #fff;
    flex-shrink: 0;
    font-size: 18px;
    box-shadow: 0 4px 15px rgba(214,43,43,0.3);
  }
  .rbody{flex: 1}
  .rhead{
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    margin-bottom: 8px;
  }
  .rhead .name{
    font-weight: 700;
    color: #fff;
    font-size: 16px;
  }
  .stars{
    font-size: 16px;
    color: var(--accent-light);
  }
  .rtext{
    color: #d9d9d9;
    font-size: 15px;
    line-height: 1.5;
  }
  .meta{
    display: flex;
    gap: 8px;
    margin-top: 12px;
    font-size: 13px;
    color: #999;
  }

  footer{
    margin-top: 60px;
    text-align: center;
    color: #999;
    font-size: 14px;
    padding: 20px;
    border-top: 1px solid var(--border);
  }

  /* Mobile Responsive Design */
  @media (max-width: 1024px){
    .hero{
      grid-template-columns: 1fr;
      gap: 20px;
    }
    .brand h1{
      font-size: 24px;
      letter-spacing: 1px;
    }
    .header-contact{
      align-items: flex-end;
    }
  }

  @media (max-width: 768px){
    .top-banner{
      font-size: 14px;
      padding: 10px 15px;
    }
    .top-banner a{
      display: block;
      margin: 4px 0;
    }
    
    header{
      padding: 16px 15px;
      flex-direction: column;
      gap: 12px;
      text-align: center;
    }
    .brand{
      justify-content: center;
    }
    .brand h1{
      font-size: 20px;
    }
    .logo{
      width: 45px;
      height: 45px;
      font-size: 20px;
    }
    .header-contact{
      align-items: center;
      text-align: center;
    }
    .header-contact .phone{
      font-size: 16px;
      padding: 8px 14px;
    }
    
    main{
      padding: 0 15px 80px;
      margin: 20px auto;
    }
    .card{
      padding: 20px;
    }
    .map-embed{
      height: 250px;
    }
    .gallery{
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
    }
    .gallery img{
      height: 120px;
    }
    
    .review{
      padding: 16px;
      gap: 12px;
    }
    .avatar{
      width: 45px;
      height: 45px;
      font-size: 16px;
    }
  }

  @media (max-width: 480px){
    .brand{
      flex-direction: column;
      gap: 8px;
    }
    .brand h1{
      font-size: 18px;
    }
    .hero{
      gap: 16px;
    }
    .card{
      padding: 16px;
    }
    .gallery{
      grid-template-columns: repeat(2, 1fr);
    }
    .form-actions{
      flex-direction: column;
      align-items: stretch !important;
    }
    .form-actions .btn{
      margin-bottom: 10px;
    }
  }

  /* Utility classes */
  .muted{color: #999; font-size: 13px}
  .small{font-size: 13px}
  .hidden{display: none}
  
  /* Loading states */
  .loading{
    opacity: 0.6;
    pointer-events: none;
  }
  
  /* Success/Error states */
  .success{color: #10b981}
  .error{color: #ef4444}
</style>
</head>
<body>

<div class="top-banner">
  <strong>🚗 Professional Auto Repair in Oklahoma City</strong>
  <a href="tel:+14058968184">Call Now: (405) 896-8184</a>
  <a href="mailto:andersonroadautomotive@gmail.com">Email Us</a>
</div>

<header>
  <div class="brand" aria-label="Anderson Automotive">
    <div class="logo">AA</div>
    <h1>ANDERSON AUTOMOTIVE</h1>
  </div>
  <div class="header-contact">
    <a class="phone" href="tel:+14058968184" aria-label="Call Anderson Automotive">
      📞 (405) 896-8184
    </a>
    <a class="email" href="mailto:andersonroadautomotive@gmail.com">
      andersonroadautomotive@gmail.com
    </a>
    <div class="address">📍 7500 S Anderson Rd, Oklahoma City, OK 73150</div>
  </div>
</header>

<main>
  <section class="hero">
    <div class="card about" aria-labelledby="about-title">
      <h2 id="about-title">Anderson Automotive</h2>
      <p>Your trusted partner for comprehensive auto repair services in Oklahoma City. We provide honest diagnostics, quality repairs, and exceptional customer service with fast turnarounds you can count on.</p>

      <div class="info-section">
        <div class="title">🕒 Business Hours</div>
        <div class="hours">
          <div class="row"><span>Monday</span><span>8:00 AM – 5:00 PM</span></div>
          <div class="row"><span>Tuesday</span><span>8:00 AM – 5:00 PM</span></div>
          <div class="row"><span>Wednesday</span><span>8:00 AM – 5:00 PM</span></div>
          <div class="row"><span>Thursday</span><span>8:00 AM – 5:00 PM</span></div>
          <div class="row"><span>Friday</span><span>8:00 AM – 5:00 PM</span></div>
          <div class="row"><span>Saturday</span><span>8:00 AM – 5:00 PM</span></div>
          <div class="row"><span>Sunday</span><span>Closed</span></div>
        </div>
      </div>

      <div class="info-section">
        <div class="title">📍 Our Location</div>
        <div class="muted small">7500 S Anderson Rd, Oklahoma City, OK 73150</div>
        <div class="map-embed" style="margin-top: 12px;">
          <iframe
            src="https://www.google.com/maps?q=7500+S+Anderson+Rd,+Oklahoma+City,+OK+73150&output=embed"
            width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"
            title="Anderson Automotive Location Map"></iframe>
        </div>
      </div>

      <div class="info-section">
        <div class="title">📸 Shop Photos</div>
        <div class="gallery" id="gallery">
          <img src="Andersonautophotos1.png" alt="Anderson Automotive shop exterior" onerror="this.style.opacity=0.4" />
          <img src="Andersonautophotos2.png" alt="Professional auto repair equipment" onerror="this.style.opacity=0.4" />
          <img src="Andersonautophotos3.png" alt="Clean service bay" onerror="this.style.opacity=0.4" />
          <img src="Andersonautophotos4.png" alt="Diagnostic equipment" onerror="this.style.opacity=0.4" />
          <img src="Andersonautophotos5.png" alt="Customer waiting area" onerror="this.style.opacity=0.4" />
          <img src="Andersonautophotos6.png" alt="Anderson Automotive team" onerror="this.style.opacity=0.4" />
        </div>
      </div>
    </div>

    <aside class="sidebar">
      <div class="card contact-card" aria-label="Contact & booking">
        <h3>Contact & Get Estimate</h3>
        <p class="muted">Get in touch for a free estimate or to schedule your service appointment.</p>

        <form id="contactForm" aria-label="Contact form">
          <input type="hidden" id="formSubject" value="Website Inquiry - Anderson Automotive" />
          
          <div>
            <label for="name">Full Name *</label>
            <input id="name" name="name" placeholder="Your full name" required />
          </div>

          <div>
            <label for="phone">Phone Number</label>
            <input id="phone" name="phone" type="tel" placeholder="(555) 555-5555" />
          </div>

          <div>
            <label for="email">Email Address *</label>
            <input id="email" name="email" type="email" placeholder="your@email.com" required />
          </div>

          <div>
            <label for="message">Service Request / Message</label>
            <textarea id="message" name="message" rows="4" placeholder="Describe your automotive issue or service needs..."></textarea>
          </div>

          <div class="form-actions" style="display:flex; gap:12px; justify-content:space-between; align-items:center;">
            <button type="submit" class="btn">Send Message</button>
            <div class="small muted">
              Or call: <a href="tel:+14058968184" style="color:var(--accent-light);text-decoration:underline">(405) 896-8184</a>
            </div>
          </div>

          <div id="formStatus" class="muted small" style="margin-top:8px;"></div>
        </form>
      </div>

      <div class="card">
        <div class="title" style="color:var(--accent-red); font-weight:600; margin-bottom:12px;">🔗 Quick Actions</div>
        <div class="quick-links">
          <a href="tel:+14058968184">📞 Call: (405) 896-8184</a>
          <a href="mailto:andersonroadautomotive@gmail.com">✉️ Email Us</a>
          <a href="https://github.com/JamesBrownR/Anderson-Automotive/" target="_blank">💻 GitHub Repository</a>
        </div>
        <div style="margin-top:16px; padding:12px; background:rgba(255,255,255,0.02); border-radius:8px;">
          <div class="small muted">Square Location ID:</div>
          <code id="squareIdLabel" style="color:var(--accent-light); font-size:12px;">YOUR_LOCATION_ID</code>
        </div>
      </div>
    </aside>
  </section>

  <section class="card">
    <h2 style="color:var(--accent-red); margin-top:0; display:flex; align-items:center; gap:8px;">
      ⭐ Customer Reviews
    </h2>
    <p class="muted small">See what our satisfied customers have to say about Anderson Automotive's professional service and quality repairs.</p>

    <div class="reviews-grid" id="reviewsGrid" aria-live="polite"></div>

    <div style="margin-top:20px; display:flex; gap:16px; align-items:center; justify-content:space-between; flex-wrap:wrap;">
      <button id="toggleMore" class="btn" style="display:none">Show More Reviews</button>
      <div id="reviewsCount" class="muted small"></div>
    </div>
  </section>

  <footer class="muted">
    &copy; <span id="year"></span> Anderson Automotive — Professional Auto Repair Services<br>
    📍 7500 S Anderson Rd, Oklahoma City, OK 73150 | 📞 (405) 896-8184
  </footer>
</main>

<script>
/*
  IMPORTANT INSTRUCTIONS (READ BEFORE EDITING):
  - Replace the Square location ID: set the SQUARE_LOCATION_ID below to your real ID.
  - If you want contact form to POST to a service, set FORM_ENDPOINT to the URL (e.g., Formspree endpoint).
  - To populate reviews, replace the REVIEWS array content below with the exact review objects you have.
    The site expects an array of objects in this compressed format (no extra text), for example:
      { name: "Reviewer 9", rating: 5, body: "" },
    Paste those lines between the square brackets. Do NOT change the rendering code unless you know JS.
  - The display logic will show 6 reviews initially and reveal 6 more each time "Show more" is clicked.
*/

/* Replace this with your Square Location ID */
const SQUARE_LOCATION_ID = 'YOUR_LOCATION_ID'; // <<--- REPLACE HERE

// OPTIONAL: If you have a form endpoint (Formspree or other), set it here.
// If left as null/empty, the script will fallback to mailto: to send the message using user's client.
const FORM_ENDPOINT = ''; // e.g. 'https://formspree.io/f/xxxxxxxx' or leave '' to fallback to mailto

document.getElementById('squareIdLabel').textContent = SQUARE_LOCATION_ID || 'YOUR_LOCATION_ID';
document.getElementById('year').textContent = new Date().getFullYear();

/* -------------------------
   REVIEWS ARRAY - PASTE HERE
   Replace the sample entries below with your actual review objects.
   Keep the same format: { name: "Name", rating: 5, body: "" },
   Example of compressed empty-body review:
     { name: "Reviewer 9", rating: 5, body: "" },
   If you have Brian Rose (3) or Wanda WalPole (4) include their ratings exactly as provided.
   ------------------------- */
const REVIEWS = [
  // Sample/demo reviews. Replace these lines with your exact review objects.
  { name: "R R", rating: 5, body: "" },
  { name: "Lindsay King", rating: 5, body: "" },
  { name: "Ron Murray", rating: 5, body: "" },
  { name: "chaynee malone", rating: 5, body: "" },
  { name: "jeff hays", rating: 5, body: "" },
  { name: "Ashley England", rating: 5, body: "" },
  { name: "Kaden Woodring", rating: 5, body: "" },
  { name: "Anthony Jade", rating: 5, body: "" },
  { name: "hot chocol8te", rating: 5, body: "" },
  { name: "Karen Stone", rating: 5, body: "" },
  { name: "Brian Rose", rating: 3, body: "" },
  { name: "Wanda WalPole", rating: 4, body: "" },
  { name: "Reviewer 13", rating: 5, body: "" }
];
/* -------------------------
   END REVIEWS ARRAY
   ------------------------- */

(function renderReviews(){
  const grid = document.getElementById('reviewsGrid');
  const toggleBtn = document.getElementById('toggleMore');
  const countLabel = document.getElementById('reviewsCount');

  // Defensive: ensure array is valid
  const reviews = Array.isArray(REVIEWS) ? REVIEWS : [];

  // create star string
  function stars(r){
    const rating = Math.max(0, Math.min(5, Math.round(r || 0)));
    const full = '★'.repeat(rating);
    const empty = '☆'.repeat(5 - rating);
    return '<span class="stars" aria-label="'+rating+' out of 5 stars">'+full+empty+'</span>';
  }

  // create avatar initials
  function initials(name){
    if(!name || name.trim() === '') return 'AA';
    const parts = name.trim().split(/\s+/).filter(Boolean);
    if(parts.length === 1) return (parts[0][0] || 'A').toUpperCase();
    return ((parts[0][0]||'A') + (parts[parts.length-1][0]||'A')).toUpperCase();
  }

  // Render review card
  function renderReviewHTML(r){
    const safeName = (r.name || 'Anonymous').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    const safeBody = (r.body || '').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    const reviewText = safeBody.trim() || '<span class="muted" style="font-style:italic;">Great service! Highly recommended.</span>';
    
    return `
      <div class="review">
        <div class="avatar" aria-hidden="true">${initials(safeName)}</div>
        <div class="rbody">
          <div class="rhead">
            <div class="name">${safeName}</div>
            <div>${stars(r.rating)}</div>
          </div>
          <div class="rtext">${reviewText}</div>
          <div class="meta">
            <div class="muted small">✅ Verified Customer</div>
          </div>
        </div>
      </div>
    `;
  }

  // Pagination logic: show first 6 and reveal 6 more each click
  const PAGE_SIZE = 6;
  let visible = Math.min(PAGE_SIZE, reviews.length);

  function updateUI(){
    if(reviews.length === 0){
      grid.innerHTML = '<div class="muted" style="text-align:center; padding:40px;">Reviews will be displayed here once added.</div>';
      toggleBtn.style.display = 'none';
      countLabel.textContent = 'No reviews yet';
      return;
    }

    grid.innerHTML = reviews.slice(0, visible).map(renderReviewHTML).join('');
    
    if(visible < reviews.length){
      toggleBtn.style.display = 'inline-flex';
      const remaining = Math.min(PAGE_SIZE, reviews.length - visible);
      toggleBtn.textContent = `Show More Reviews (${remaining} more)`;
    } else if(reviews.length > PAGE_SIZE){
      toggleBtn.style.display = 'inline-flex';
      toggleBtn.textContent = 'Show Less Reviews';
    } else {
      toggleBtn.style.display = 'none';
    }
    
    countLabel.textContent = `Showing ${Math.min(visible, reviews.length)} of ${reviews.length} reviews`;
  }

  toggleBtn.addEventListener('click', ()=>{
    if(visible < reviews.length){
      // reveal next PAGE_SIZE reviews
      visible = Math.min(reviews.length, visible + PAGE_SIZE);
    } else {
      // collapse back to first PAGE_SIZE
      visible = Math.min(PAGE_SIZE, reviews.length);
    }
    updateUI();
    
    // Smooth scroll to reviews section when expanding
    if(visible > PAGE_SIZE){
      setTimeout(() => {
        document.querySelector('.reviews-grid').scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start' 
        });
      }, 100);
    }
  });

  updateUI();
})();

/* -----------------------------
   CONTACT FORM HANDLING
   - If FORM_ENDPOINT is set, POST JSON to it.
   - Otherwise fallback to generating a mailto: link so user's email client opens.
   ----------------------------- */
(function setupForm(){
  const form = document.getElementById('contactForm');
  const status = document.getElementById('formStatus');
  const submitBtn = form.querySelector('button[type="submit"]');
  const originalBtnText = submitBtn.textContent;

  form.addEventListener('submit', async (ev)=>{
    ev.preventDefault();
    
    // Update UI to show loading state
    submitBtn.textContent = 'Sending...';
    submitBtn.disabled = true;
    form.classList.add('loading');
    status.textContent = 'Sending your message...';
    status.className = 'muted small';

    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const email = document.getElementById('email').value.trim();
    const msg = document.getElementById('message').value.trim();
    const subject = document.getElementById('formSubject').value || 'Website Inquiry';

    // Basic validation
    if(!name || !email){
      status.textContent = 'Please fill in all required fields.';
      status.className = 'error small';
      resetForm();
      return;
    }

    // If FORM_ENDPOINT provided, try to POST
    if(FORM_ENDPOINT && FORM_ENDPOINT.trim()){
      try{
        const payload = {
          name, phone, email, message: msg, subject, 
          locationId: SQUARE_LOCATION_ID,
          timestamp: new Date().toISOString()
        };
        
        const res = await fetch(FORM_ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        
        if(res.ok){
          status.textContent = '✅ Message sent successfully! We\'ll contact you soon.';
          status.className = 'success small';
          form.reset();
          
          // Auto-hide success message after 5 seconds
          setTimeout(() => {
            status.textContent = '';
          }, 5000);
        } else {
          throw new Error('Server responded with error');
        }
      }catch(err){
        console.error('Form submission error:', err);
        status.textContent = 'Connection failed. Opening email client as backup...';
        status.className = 'muted small';
        setTimeout(()=> fallbackMail(), 1000);
      }
    } else {
      fallbackMail();
    }

    function fallbackMail(){
      const bodyLines = [
        `Name: ${name}`,
        `Phone: ${phone}`,
        `Email: ${email}`,
        '',
        `Service Request:`,
        msg || 'No specific message provided.',
        '',
        `Submitted via website on: ${new Date().toLocaleString()}`,
        `Square Location ID: ${SQUARE_LOCATION_ID}`
      ];
      
      const mailto = `mailto:andersonroadautomotive@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(bodyLines.join('\n'))}`;
      window.location.href = mailto;
      
      status.textContent = '📧 Email client opened. If nothing happened, please call us directly at (405) 896-8184.';
      status.className = 'muted small';
    }

    function resetForm(){
      submitBtn.textContent = originalBtnText;
      submitBtn.disabled = false;
      form.classList.remove('loading');
    }

    // Reset form state after delay
    setTimeout(resetForm, 2000);
  });

  // Real-time form validation feedback
  const inputs = form.querySelectorAll('input[required]');
  inputs.forEach(input => {
    input.addEventListener('blur', () => {
      if(input.value.trim() === ''){
        input.style.borderColor = '#ef4444';
      } else {
        input.style.borderColor = '';
      }
    });
    
    input.addEventListener('input', () => {
      input.style.borderColor = '';
    });
  });
})();

// Add smooth scrolling for anchor links
document.addEventListener('DOMContentLoaded', () => {
  // Smooth scroll for all internal anchor links
  const links = document.querySelectorAll('a[href^="#"]');
  links.forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const target = document.querySelector(link.getAttribute('href'));
      if(target){
        target.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });

  // Add loading animation for images
  const images = document.querySelectorAll('.gallery img');
  images.forEach(img => {
    img.addEventListener('load', () => {
      img.style.opacity = '1';
    });
    
    img.addEventListener('error', () => {
      img.style.opacity = '0.3';
      img.style.background = 'linear-gradient(45deg, #333, #555)';
      img.alt = 'Image not available';
    });
  });
});

// Add intersection observer for animations
if('IntersectionObserver' in window){
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if(entry.isIntersecting){
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);

  // Observe cards for scroll animations
  document.addEventListener('DOMContentLoaded', () => {
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
      observer.observe(card);
    });
  });
}

</script>
</body>
</html>
